# è¯·æ±‚é™æµè¯´æ˜

## ğŸ“‹ é™æµç­–ç•¥

### è®¤è¯é™æµï¼ˆauthLimiterï¼‰

**é…ç½®ä½ç½®**: `src/middlewares/rate-limit.middleware.ts`

**é™åˆ¶è§„åˆ™**:
- **æ—¶é—´çª—å£**: 15åˆ†é’Ÿ
- **æœ€å¤§å¤±è´¥æ¬¡æ•°**: 6æ¬¡ï¼ˆå…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡å¤±è´¥æ—¶æ‰å¼€å§‹é™æµï¼‰
- **å…³é”®ç‰¹æ€§**: **åªå¯¹å¤±è´¥çš„ç™»å½•/æ³¨å†Œè¯·æ±‚è¿›è¡Œé™æµ**

### å·¥ä½œåŸç†

1. **æˆåŠŸè¯·æ±‚ä¸è®¡å…¥é™åˆ¶**
   - å½“ `skipSuccessfulRequests: true` æ—¶
   - åªæœ‰è¿”å› 2xx çŠ¶æ€ç çš„è¯·æ±‚ä¸ä¼šè¢«è®¡å…¥é™æµè®¡æ•°
   - æˆåŠŸçš„ç™»å½•/æ³¨å†Œå¯ä»¥æ— é™æ¬¡è¿›è¡Œ

2. **å¤±è´¥è¯·æ±‚è®¡å…¥é™åˆ¶**
   - è¿”å› 4xx æˆ– 5xx çŠ¶æ€ç çš„è¯·æ±‚ä¼šè¢«è®¡å…¥é™æµè®¡æ•°
   - 15åˆ†é’Ÿå†…å…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡å¤±è´¥æ—¶æ‰å¼€å§‹é™æµ
   - è¿™æ ·å¯ä»¥ç»™ç”¨æˆ·åˆç†çš„å®¹é”™ç©ºé—´ï¼ŒåŒæ—¶é˜²æ­¢æš´åŠ›ç ´è§£

3. **é™æµè§¦å‘æ—¶æœº**
   - é™æµæ£€æŸ¥åœ¨è¯·æ±‚å¤„ç†ä¹‹å‰è¿›è¡Œ
   - å¦‚æœå·²ç»è¾¾åˆ°é™åˆ¶ï¼Œç›´æ¥è¿”å›é™æµé”™è¯¯ï¼Œä¸ä¼šç»§ç»­å¤„ç†è¯·æ±‚

## ğŸ§ª æµ‹è¯•ç»“æœ

### æˆåŠŸç™»å½•æµ‹è¯•
```bash
# è¿ç»­3æ¬¡æˆåŠŸç™»å½•
æˆåŠŸç™»å½• 1: true âœ…
æˆåŠŸç™»å½• 2: true âœ…
æˆåŠŸç™»å½• 3: true âœ…
```
**ç»“æœ**: æˆåŠŸçš„ç™»å½•è¯·æ±‚ä¸å—é™æµå½±å“ âœ…

### å¤±è´¥ç™»å½•æµ‹è¯•
```bash
# è¿ç»­7æ¬¡å¤±è´¥ç™»å½•
å¤±è´¥ç™»å½•å°è¯• 1-5: User login input error âœ… (æ­£å¸¸å¤„ç†ï¼Œå…è®¸å¤±è´¥)
å¤±è´¥ç™»å½•å°è¯• 6: ç™»å½•/æ³¨å†Œå¤±è´¥æ¬¡æ•°è¿‡å¤šï¼Œè¯·15åˆ†é’Ÿåå†è¯• âš ï¸ (ç¬¬6æ¬¡å¤±è´¥ï¼Œå¼€å§‹é™æµ)
å¤±è´¥ç™»å½•å°è¯• 7: ç™»å½•/æ³¨å†Œå¤±è´¥æ¬¡æ•°è¿‡å¤šï¼Œè¯·15åˆ†é’Ÿåå†è¯• âš ï¸ (ç»§ç»­é™æµ)
```
**ç»“æœ**: å…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡å¤±è´¥æ—¶æ‰å¼€å§‹é™æµ âœ…

## âœ… å½“å‰å®ç°

### é…ç½®
```typescript
export const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,  // 15åˆ†é’Ÿ
  max: 6,                      // æœ€å¤š6æ¬¡å¤±è´¥å°è¯•ï¼ˆå…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡æ‰é™æµï¼‰
  skipSuccessfulRequests: true,  // æˆåŠŸè¯·æ±‚ä¸è®¡å…¥é™åˆ¶
  requestWasSuccessful: (req, res) => {
    return res.statusCode >= 200 && res.statusCode < 300;
  }
});
```

### è¡Œä¸ºè¯´æ˜

1. **æ­£å¸¸ç”¨æˆ·**:
   - å¯ä»¥æ— é™æ¬¡æˆåŠŸç™»å½•
   - ä¸ä¼šå› ä¸ºæ­£å¸¸ä½¿ç”¨è€Œè¢«é™æµ

2. **æ¶æ„ç”¨æˆ·**:
   - 15åˆ†é’Ÿå†…å…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡å¤±è´¥æ—¶å¼€å§‹é™æµ
   - é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»ï¼ŒåŒæ—¶ç»™ç”¨æˆ·åˆç†çš„å®¹é”™ç©ºé—´

3. **é”™è¯¯åœºæ™¯**:
   - è¾“å…¥éªŒè¯å¤±è´¥ï¼ˆ422ï¼‰â†’ è®¡å…¥é™æµ
   - ç”¨æˆ·ä¸å­˜åœ¨ï¼ˆ422ï¼‰â†’ è®¡å…¥é™æµ
   - å¯†ç é”™è¯¯ï¼ˆ422ï¼‰â†’ è®¡å…¥é™æµ
   - ç™»å½•æˆåŠŸï¼ˆ200ï¼‰â†’ ä¸è®¡å…¥é™æµ

## ğŸ“Š é™æµçŠ¶æ€ç 

- **200-299**: æˆåŠŸè¯·æ±‚ï¼Œä¸è®¡å…¥é™æµ âœ…
- **400-499**: å®¢æˆ·ç«¯é”™è¯¯ï¼Œè®¡å…¥é™æµ âš ï¸
- **500-599**: æœåŠ¡å™¨é”™è¯¯ï¼Œè®¡å…¥é™æµ âš ï¸

## ğŸ¯ æ€»ç»“

å½“å‰çš„é™æµå®ç°**å®Œå…¨ç¬¦åˆè¦æ±‚**ï¼š
- âœ… åªå¯¹å¤±è´¥çš„ç™»å½•/æ³¨å†Œè¯·æ±‚è¿›è¡Œé™æµ
- âœ… å…è®¸å¤±è´¥5æ¬¡ï¼Œç¬¬6æ¬¡å¤±è´¥æ—¶æ‰å¼€å§‹é™æµï¼ˆç»™ç”¨æˆ·åˆç†çš„å®¹é”™ç©ºé—´ï¼‰
- âœ… æˆåŠŸçš„è¯·æ±‚ä¸å—é™æµå½±å“
- âœ… æœ‰æ•ˆé˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»
- âœ… ä¸å½±å“æ­£å¸¸ç”¨æˆ·ä½¿ç”¨
